(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-task-defect-defectHandle"],{"2abc":function(e,t,a){var r=a("d0af");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=a("4f06").default;o("58de4ea3",r,!0,{sourceMap:!1,shadowMode:!1})},"2d1a":function(e,t,a){"use strict";var r=a("2abc"),o=a.n(r);o.a},"2e3f":function(e,t,a){"use strict";var r=a("dbce");Object.defineProperty(t,"__esModule",{value:!0}),t.defOverdue=t.defFindByDef=t.defSaveOrUpdate=t.defclaDetail=t.deflist=void 0;var o=r(a("5f30")),i=function(e){return(0,o.default)({url:"/blade-sd/def/list",method:"get",data:e})};t.deflist=i;var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.default)({url:"/blade-sd/defcla/detail",method:"get",data:e})};t.defclaDetail=n;var d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,o.default)({url:"/blade-sd/def/saveOrUpdate",method:"post",data:e})};t.defSaveOrUpdate=d;var l=function(e){return(0,o.default)({url:"/blade-sd/def/findByDef/"+e,method:"get"})};t.defFindByDef=l;var s=function(){return(0,o.default)({url:"/blade-sd/def/overdue",method:"get"})};t.defOverdue=s},"3fce":function(e,t,a){"use strict";a.r(t);var r=a("cdaf"),o=a("f8e6");for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("2d1a");var n,d=a("f0c5"),l=Object(d["a"])(o["default"],r["b"],r["c"],!1,null,"7d9afe61",null,!1,r["a"],n);t["default"]=l.exports},"5a3c":function(e,t,a){"use strict";var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(a("a3d0")),i={components:{HandleForm:o.default},data:function(){return{loading:!1,id:""}},onLoad:function(e){this.id=e.id},onReady:function(){},methods:{submit:function(){var e=this;this.loading=!0,this.$refs.HandleForm.submit().then((function(){e.loading=!1,setTimeout((function(){e.$goBack()}),500)})).catch((function(){e.loading=!1}))}}};t.default=i},"83b5":function(e,t,a){"use strict";a.r(t);var r=a("f012"),o=a.n(r);for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);t["default"]=o.a},9798:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r}));var r={uForm:a("586b").default,uFormItem:a("e2f4").default,uRadioGroup:a("9b70").default,uRadio:a("7d14").default,uToast:a("4463").default},o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("u-form",{ref:"uForm",attrs:{model:e.form,"error-type":["toast"]}},[a("u-form-item",{attrs:{label:"消缺单位",prop:"cleOrg","label-width":"150"}},[a("efItem",{attrs:{data:e.formList.dy_YWDW,modelId:e.form.cleOrg,type:"add"===e.type?"select":"label",name:"fullName",id:"id"},on:{"update:modelId":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"cleOrg",t)},"update:model-id":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"cleOrg",t)}},model:{value:e.form.cleOrgName,callback:function(t){e.$set(e.form,"cleOrgName",t)},expression:"form.cleOrgName"}})],1),a("u-form-item",{attrs:{label:"消缺班组",prop:"cleTeam","label-width":"150"}},[a("efItem",{attrs:{data:e.formList.dy_findTeamName,modelId:e.form.cleTeam,type:"add"===e.type?"select":"label",name:"fullName",id:"id"},on:{"update:modelId":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"cleTeam",t)},"update:model-id":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"cleTeam",t)},change:function(t){arguments[0]=t=e.$handleEvent(t),e.classChange.apply(void 0,arguments)}},model:{value:e.form.cleTeamName,callback:function(t){e.$set(e.form,"cleTeamName",t)},expression:"form.cleTeamName"}})],1),a("u-form-item",{attrs:{label:"消缺人",prop:"cleUser","label-width":"150"}},[a("efItem",{attrs:{data:e.dy_teamUserList,modelId:e.form.cleUser,defaultValue:e.form.cleUser,multiple:!0,type:"add"===e.type?"people":"label"},on:{"update:modelId":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"cleUser",t)},"update:model-id":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"cleUser",t)}},model:{value:e.form.cleUserName,callback:function(t){e.$set(e.form,"cleUserName",t)},expression:"form.cleUserName"}})],1),a("u-form-item",{attrs:{label:"消缺时间",prop:"cleDate","label-width":"150"}},[a("efItem",{attrs:{endTime:e.$store.state.nowDate,type:"add"===e.type?"time":"label"},model:{value:e.form.cleDate,callback:function(t){e.$set(e.form,"cleDate",t)},expression:"form.cleDate"}})],1),a("u-form-item",{attrs:{label:"工作负责人",prop:"workLeader","label-width":"150"}},[a("efItem",{attrs:{data:e.dy_teamUserList,modelId:e.form.workLeader,defaultValue:e.form.workLeader,type:"add"===e.type?"people":"label"},on:{"update:modelId":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"workLeader",t)},"update:model-id":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"workLeader",t)}},model:{value:e.form.workLeaderName,callback:function(t){e.$set(e.form,"workLeaderName",t)},expression:"form.workLeaderName"}})],1),a("u-form-item",{attrs:{label:"是否延期",prop:"isLay","label-width":"150"}},[a("v-uni-view",{staticClass:"flex1 flex-end"},["add"===e.type?[a("u-radio-group",{attrs:{"active-color":"#05b2cc"},model:{value:e.form.isLay,callback:function(t){e.$set(e.form,"isLay",t)},expression:"form.isLay"}},[a("u-radio",{attrs:{shape:"circle",name:2}},[e._v("是")]),a("u-radio",{attrs:{shape:"circle",name:1}},[e._v("否")])],1)]:[a("v-uni-text",{staticStyle:{"font-size":"24rpx"}},[e._v(e._s((2==e.form.isLay?"是":1==e.form.isLay&&"否")||""))])]],2)],1),2==e.form.isLay?[a("u-form-item",{attrs:{label:"延期说明",prop:"layDesc","label-width":"150"}},[a("efItem",{attrs:{title:"延期说明",isRightIcon:!1,type:"add"===e.type?"textarea":"label",placeholder:"请输入"},model:{value:e.form.layDesc,callback:function(t){e.$set(e.form,"layDesc",t)},expression:"form.layDesc"}})],1)]:e._e(),a("u-form-item",{attrs:{label:"处理结果",prop:"cleDesc","label-width":"150"}},[a("efItem",{attrs:{title:"处理结果",isRightIcon:!1,type:"add"===e.type?"textarea":"label",placeholder:"请输入"},model:{value:e.form.cleDesc,callback:function(t){e.$set(e.form,"cleDesc",t)},expression:"form.cleDesc"}})],1),a("u-form-item",{attrs:{label:"遗留问题",prop:"cleContent","label-width":"150"}},[a("efItem",{attrs:{title:"遗留问题",isRightIcon:!1,type:"add"===e.type?"textarea":"label",placeholder:"请输入"},model:{value:e.form.cleContent,callback:function(t){e.$set(e.form,"cleContent",t)},expression:"form.cleContent"}})],1),a("u-form-item",{attrs:{prop:"defClePicVOList",label:"拍照","label-width":"150","label-position":"top"}},[a("chooseImage",{ref:"chooseImage",attrs:{images:e.form.defClePicVOList,type:e.type}})],1),a("u-form-item",{attrs:{prop:"defCleVoiVOList",label:"录音","label-width":"150","label-position":"top"}},[a("chooseAudio",{ref:"chooseAudio",attrs:{audioList:e.form.defCleVoiVOList,type:e.type}})],1),a("u-form-item",{attrs:{prop:"defCleVidVOList",label:"视频","label-width":"150","label-position":"top"}},[a("chooseVideo",{ref:"chooseVideo",attrs:{videoList:e.form.defCleVidVOList,type:e.type}})],1)],2),a("u-toast",{ref:"uToast"})],1)},i=[]},"97ac":function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,".container[data-v-4e4301b5]{margin:0 %?16?%;background:#fff;-webkit-box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);-webkit-border-radius:%?24?%;border-radius:%?24?%;padding:%?15?% %?40?% %?15?% %?40?%;-webkit-box-sizing:border-box;box-sizing:border-box}",""]),e.exports=t},"9e0c":function(e,t,a){"use strict";a("d3b7"),Object.defineProperty(t,"__esModule",{value:!0}),t.dictMixins=void 0;var r=a("2e12"),o=a("a78e"),i={data:function(){return{dy_teamUserList:[],dy_invtwrList:[]}},methods:{selectTeamUserList:function(e){var t=this;(0,r.selectTeamUserList)({deptId:e||this.form.teamId}).then((function(e){var a=e.data;t.dy_teamUserList=a.data.records||[]}))},getInvtwrList:function(){var e=this;return new Promise((function(t,a){(0,o.towersPMS)({line:e.form.lineId||""}).then((function(a){var r=a.data;console.log(r,"杆塔data===="),e.dy_invtwrList=r.data.records||[],t(r.data.records)})).catch((function(){a()}))}))}}};t.dictMixins=i},a0df:function(e,t,a){var r=a("97ac");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var o=a("4f06").default;o("2222eeed",r,!0,{sourceMap:!1,shadowMode:!1})},a3d0:function(e,t,a){"use strict";a.r(t);var r=a("9798"),o=a("83b5");for(var i in o)"default"!==i&&function(e){a.d(t,e,(function(){return o[e]}))}(i);a("b651");var n,d=a("f0c5"),l=Object(d["a"])(o["default"],r["b"],r["c"],!1,null,"4e4301b5",null,!1,r["a"],n);t["default"]=l.exports},a78e:function(e,t,a){"use strict";var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.twrsetSubmit=t.invtwrDetail=t.towersPMS=t.invtwrList=void 0;var o=r(a("5530")),i=r(a("5f30")),n=function(e){return(0,i.default)({url:"/blade-sd/invtwr/listAllByLineID",method:"GET",data:e})};t.invtwrList=n;var d=function(e){return(0,i.default)({url:"/blade-sd/api/towers",method:"GET",data:(0,o.default)({current:1,size:999999},e)})};t.towersPMS=d;var l=function(e){return(0,i.default)({url:"/blade-sd/invtwr/detail",method:"get",data:e})};t.invtwrDetail=l;var s=function(e){return(0,i.default)({url:"/blade-sd/twrset/submit",method:"post",data:e})};t.twrsetSubmit=s},b651:function(e,t,a){"use strict";var r=a("a0df"),o=a.n(r);o.a},cdaf:function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return r}));var r={customNavbar:a("384b").default,uButton:a("147a").default,uToast:a("4463").default},o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("custom-navbar",{attrs:{title:"处理缺陷",iconLeft:!0}}),a("v-uni-view",{staticClass:"container"},[a("HandleForm",{ref:"HandleForm",attrs:{id:e.id}}),a("u-button",{staticClass:"ef-btn",attrs:{type:"primary",ripple:!0,loading:e.loading},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("确认")])],1),a("u-toast",{ref:"uToast"})],1)},i=[]},d0af:function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,".container[data-v-7d9afe61]{margin:0 %?16?%;background:#fff;-webkit-box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);-webkit-border-radius:%?24?%;border-radius:%?24?%;padding:%?15?% %?40?% %?15?% %?40?%;-webkit-box-sizing:border-box;box-sizing:border-box}",""]),e.exports=t},f012:function(e,t,a){"use strict";var r=a("4ea4");a("d3b7"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var o=r(a("1da1")),i=a("9e0c"),n=a("2e3f"),d=a("ecc0"),l=r(a("b35f")),s=r(a("b299")),f=r(a("6679")),c=r(a("b760")),u={components:{efItem:l.default,chooseImage:s.default,chooseVideo:f.default,mRecorder:c.default},mixins:[i.dictMixins],props:{id:{type:String,default:""},type:{type:String,default:"add"},needGet:{type:Boolean,default:!0},details:{type:Object,default:function(){}}},data:function(){return{formList:{dy_findTeamName:[],dy_plCleorg:[]},form:{cleOrgName:"",cleOrg:"",cleTeam:"",cleTeamName:"",cleUser:"",cleUserName:"",cleDate:"",workLeader:"",workLeaderName:"",isLay:1,layDesc:"",cleDesc:"",cleContent:""},rules:{cleOrg:[{required:!0,message:"请选择消缺单位"}],cleUser:[{required:!0,message:"请选择消缺人"}],cleDate:[{required:!0,message:"请选择消缺时间"}],workLeader:[{required:!0,message:"请选择负责人"}],isLay:[{required:!0,message:"请选择是否延期"}]}}},created:function(){this._defFindByDef()},mounted:function(){this.$refs.uForm.setRules(this.rules)},watch:{details:{handler:function(e){if(console.log(e,"缺陷详情处理"),!this.needGet){if(this.form=e,!this.form.cleUserName&&!this.form.cleUser){var t=(0,d.getStore)("userInfo");this.form.cleUserName=t.nick_name,this.form.cleUser=t.user_id}this.getTypelist()}},deep:!0,immediate:!0},form:{handler:function(e){var t=this;console.log(e,"handle的form"),setTimeout((function(){t.$emit("over")}),300)},deep:!0}},methods:{getTypelist:function(){var e=this;"details"!=this.type&&(this.$store.dispatch("getList","YWDW").then((function(t){console.log(t,"运维单位"),e.formList.dy_YWDW=t||[],1!==t.length||e.form.cleOrg||e.form.cleOrgName||(e.form.cleOrgName=t[0].fullName,e.form.cleOrg=t[0].id)})),this.$store.dispatch("getList","YSBZ").then((function(t){console.log(t,"班组"),e.formList.dy_findTeamName=t||[];var a=t||[];1!=a.length||e.form.cleTeam||e.form.cleTeamName||(e.form.cleTeam=a[0].id,e.form.cleTeamName=a[0].fullName,e.selectTeamUserList(e.form.cleTeam))})),this.$store.dispatch("getList","JHXQDW").then((function(t){console.log(t,"计划消缺单位"),e.formList.dy_plCleorg=t||[]})))},submit:function(){var e=this;return new Promise((function(t,a){e.$refs.uForm.validate(function(){var r=(0,o.default)(regeneratorRuntime.mark((function r(o){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!o){r.next=15;break}return console.log(e.form,"form"),e.form.defState="3",r.next=5,e.$refs.chooseImage.getIds();case 5:return e.form.clePic=r.sent,r.next=8,e.$refs.chooseVideo.getIds();case 8:return e.form.cleVid=r.sent,r.next=11,e.$refs.chooseAudio.getIds();case 11:e.form.cleVoi=r.sent,(0,n.defSaveOrUpdate)(e.form).then((function(){e.$refs.uToast.show({title:"处理成功！"}),t()})),r.next=16;break;case 15:a();case 16:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}))},_defFindByDef:function(){var e=this;this.needGet&&(0,n.defFindByDef)(this.id).then((function(t){if(console.log(t,"详情"),e.form=t.data.data,!e.form.cleUserName&&!e.form.cleUser){var a=(0,d.getStore)("userInfo");e.form.cleUserName=a.nick_name,e.form.cleUser=a.user_id}e.getTypelist()}))},classChange:function(e){console.log(e,"班组"),this.selectTeamUserList(e.id)}}};t.default=u},f8e6:function(e,t,a){"use strict";a.r(t);var r=a("5a3c"),o=a.n(r);for(var i in r)"default"!==i&&function(e){a.d(t,e,(function(){return r[e]}))}(i);t["default"]=o.a}}]);