(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-task-hiddenDanger-specialTour"],{4997:function(t,e,r){var a=r("24fb");e=a(!1),e.push([t.i,".container[data-v-1102c62d]{margin:0 %?16?%;background:#fff;-webkit-box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);-webkit-border-radius:%?24?%;border-radius:%?24?%;padding:%?15?% %?40?% %?15?% %?40?%;-webkit-box-sizing:border-box;box-sizing:border-box}.btn[data-v-1102c62d]{width:%?120?%;height:%?50?%!important;-webkit-border-radius:%?30?%;border-radius:%?30?%;font-size:%?24?%!important;border-color:#05b2cc;color:#05b2cc}.btn-active[data-v-1102c62d]{color:#fff;background-color:#05b2cc}",""]),t.exports=e},"6a33":function(t,e,r){"use strict";var a=r("eb67"),o=r.n(a);o.a},"6f56":function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return a}));var a={customNavbar:r("384b").default,uForm:r("586b").default,uFormItem:r("e2f4").default,uButton:r("147a").default,uToast:r("4463").default},o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-uni-view",[r("custom-navbar",{attrs:{title:"特巡记录",iconLeft:!0}}),r("v-uni-view",{staticClass:"container flex1"},[r("u-form",{ref:"uForm",attrs:{model:t.form}},[r("u-form-item",{attrs:{prop:"troUser",label:"现场维护人员","label-width":"180"}},[r("efItem",{attrs:{data:t.dy_teamUserList,modelId:t.form.troUser,multiple:!0,type:"add"==t.actionType?"people":"label"},on:{"update:modelId":function(e){arguments[0]=e=t.$handleEvent(e),t.$set(t.form,"troUser",e)},"update:model-id":function(e){arguments[0]=e=t.$handleEvent(e),t.$set(t.form,"troUser",e)}},model:{value:t.form.troUserName,callback:function(e){t.$set(t.form,"troUserName",e)},expression:"form.troUserName"}})],1),0==t.type?[r("u-form-item",{attrs:{label:"开始时间",prop:"startTime","label-width":"150"}},[r("efItem",{attrs:{type:"add"==t.actionType?"time":"label"},model:{value:t.form.startTime,callback:function(e){t.$set(t.form,"startTime",e)},expression:"form.startTime"}})],1),r("u-form-item",{attrs:{label:"结束时间",prop:"endTime","label-width":"150"}},[r("efItem",{attrs:{type:"add"==t.actionType?"time":"label"},model:{value:t.form.endTime,callback:function(e){t.$set(t.form,"endTime",e)},expression:"form.endTime"}})],1)]:t._e(),1==t.type?[r("u-form-item",{attrs:{label:"维护时间",prop:"troDate","label-width":"150"}},[r("efItem",{attrs:{type:"add"==t.actionType?"time":"label"},model:{value:t.form.troDate,callback:function(e){t.$set(t.form,"troDate",e)},expression:"form.troDate"}})],1)]:t._e(),r("u-form-item",{attrs:{prop:"troStatusNode",label:"现场情况","label-width":"150"}},[r("efItem",{attrs:{title:"现场情况",isRightIcon:!1,type:"add"==t.actionType?"textarea":"label",placeholder:"请输入"},model:{value:t.form.troStatusNode,callback:function(e){t.$set(t.form,"troStatusNode",e)},expression:"form.troStatusNode"}})],1),0==t.type?[r("u-form-item",{attrs:{prop:"instrument",label:"使用仪器","label-width":"150"}},[r("efItem",{attrs:{title:"使用仪器",isRightIcon:!1,type:"add"==t.actionType?"textarea":"label",placeholder:"请输入"},model:{value:t.form.instrument,callback:function(e){t.$set(t.form,"instrument",e)},expression:"form.instrument"}})],1),r("u-form-item",{attrs:{prop:"objective",label:"目的","label-width":"150"}},[r("efItem",{attrs:{title:"目的",isRightIcon:!1,type:"add"==t.actionType?"textarea":"label",placeholder:"请输入"},model:{value:t.form.objective,callback:function(e){t.$set(t.form,"objective",e)},expression:"form.objective"}})],1),r("u-form-item",{attrs:{prop:"conclusion",label:"结论","label-width":"150"}},[r("efItem",{attrs:{title:"结论",isRightIcon:!1,type:"add"==t.actionType?"textarea":"label",placeholder:"请输入"},model:{value:t.form.conclusion,callback:function(e){t.$set(t.form,"conclusion",e)},expression:"form.conclusion"}})],1),r("u-form-item",{attrs:{prop:"measures",label:"需采取措施","label-width":"150"}},[r("efItem",{attrs:{title:"需采取措施",isRightIcon:!1,type:"add"==t.actionType?"textarea":"label",placeholder:"请输入"},model:{value:t.form.measures,callback:function(e){t.$set(t.form,"measures",e)},expression:"form.measures"}})],1)]:t._e(),r("u-form-item",{attrs:{label:"隐患照片","label-width":"150","label-position":"top"}},[r("chooseImage",{ref:"chooseImage",attrs:{images:t.form.troPics,type:t.actionType,picType:"3"}})],1),r("u-form-item",{attrs:{label:"隐患录音","label-width":"150","label-position":"top"}},[r("chooseAudio",{ref:"chooseAudio",attrs:{audioList:t.form.troVois,type:t.actionType,picType:"3"}})],1),r("u-form-item",{attrs:{label:"隐患视频","label-width":"150","label-position":"top"}},[r("chooseVideo",{ref:"chooseVideo",attrs:{videoList:t.form.troVids,type:t.actionType,picType:"3"}})],1)],2),"add"==t.actionType?[r("u-button",{staticClass:"ef-btn",attrs:{type:"primary",loading:t.loading,ripple:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("确认")])]:t._e()],2),r("u-toast",{ref:"uToast"})],1)},i=[]},"8d4d":function(t,e,r){"use strict";r.r(e);var a=r("6f56"),o=r("f09f");for(var i in o)"default"!==i&&function(t){r.d(e,t,(function(){return o[t]}))}(i);r("6a33");var s,n=r("f0c5"),d=Object(n["a"])(o["default"],a["b"],a["c"],!1,null,"1102c62d",null,!1,a["a"],s);e["default"]=d.exports},eb67:function(t,e,r){var a=r("4997");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var o=r("4f06").default;o("3e7aa307",a,!0,{sourceMap:!1,shadowMode:!1})},ec77:function(t,e,r){"use strict";var a=r("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.getTroTypeLevel=e.trotreeSubmit=e.depleaderListman=e.trotreemSubmit=e.troclaGetBasis=e.troclaGetType=e.trotreehSave=e.trotreeDetail=e.trotreeList=e.troexthSave=e.troextDetail=e.troextmSubmit=e.troextSubmit=e.troextList=void 0;var o=a(r("5f30")),i=function(t){return(0,o.default)({url:"/blade-sd/troext/list",method:"get",data:t})};e.troextList=i;var s=function(t){return(0,o.default)({url:"/blade-sd/troext/submit",method:"post",data:t})};e.troextSubmit=s;var n=function(t){return(0,o.default)({url:"/blade-sd/troextm/submit",method:"post",data:t})};e.troextmSubmit=n;var d=function(t){return(0,o.default)({url:"/blade-sd/troext/detail",method:"get",data:t})};e.troextDetail=d;var l=function(t){return(0,o.default)({url:"/blade-sd/troexth/save",method:"post",data:t})};e.troexthSave=l;var u=function(t){return(0,o.default)({url:"/blade-sd/trotree/list",method:"get",data:t})};e.trotreeList=u;var m=function(t){return(0,o.default)({url:"/blade-sd/trotree/detail",method:"get",data:t})};e.trotreeDetail=m;var c=function(t){return(0,o.default)({url:"/blade-sd/trotreeh/save",method:"post",data:t})};e.trotreehSave=c;var f=function(t){return(0,o.default)({url:"/blade-sd/trocla/getType",method:"get",data:t})};e.troclaGetType=f;var p=function(t){return(0,o.default)({url:"/blade-sd/trocla/getBasis",method:"get",data:t})};e.troclaGetBasis=p;var b=function(t){return(0,o.default)({url:"/blade-sd/trotreem/submit",method:"post",data:t})};e.trotreemSubmit=b;var h=function(t){return(0,o.default)({url:"/blade-sd/depleader/listman",method:"get",data:t})};e.depleaderListman=h;var v=function(t){return(0,o.default)({url:"/blade-sd/trotree/submit",method:"post",data:t})};e.trotreeSubmit=v;var g=function(t){return(0,o.default)({url:"/trocla/getTroTypeLevel",method:"get",data:t})};e.getTroTypeLevel=g},f09f:function(t,e,r){"use strict";r.r(e);var a=r("ff7f"),o=r.n(a);for(var i in a)"default"!==i&&function(t){r.d(e,t,(function(){return a[t]}))}(i);e["default"]=o.a},ff7f:function(t,e,r){"use strict";var a=r("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=a(r("5530"));r("96cf");var i=a(r("1da1")),s=a(r("b35f")),n=r("f4cb"),d=r("ecc0"),l=r("ec77"),u=r("2e12"),m={troextmSubmit:function(t){return(0,l.troextmSubmit)(t)},trotreemSubmit:function(t){return(0,l.trotreemSubmit)(t)}},c={components:{efItem:s.default},data:function(){return{loading:!1,type:"",actionType:"add",id:"",details:{},loadingSure:!1,loadingSave:!1,form:{teamName:"",teamId:"",troUser:"",startTime:"",endTime:"",troDate:"",troStatusNode:""},rules:{troUser:[{required:!0,message:"请选择维护人员"}],startTime:[{required:!0,message:"请选择开始时间"}],endTime:[{required:!0,message:"请选择结束时间"}],troDate:[{required:!0,message:"请选择维护时间"}],troStatusNode:[{required:!0,message:"请填写现场情况"}]},dy_teamUserList:[]}},onLoad:function(t){this.id=t.id,this.type=t.type,this.actionType=t.actionType||"add",this.form.teamName=t.teamName,this.form.teamId=t.teamId,t.details&&"details"==this.actionType&&(console.log((0,n.decodeData)(t.details),"options.details"),this.form=(0,n.decodeData)(t.details)),this._selectTeamUserList()},onReady:function(){this.$refs.uForm.setRules(this.rules),this.form.startTime=(0,n.getNowTime)(),this.form.endTime=(0,n.getNowTime)(),this.form.troDate=(0,n.getNowTime)();var t=(0,d.getStore)("userInfo");this.form.troUserName=t.nick_name,this.form.troUser=t.user_id},computed:{status:function(){return this.form.state||""}},methods:{_selectTeamUserList:function(){var t=this;(0,u.selectTeamUserList)({deptId:this.form.teamId}).then((function(e){var r=e.data;t.dy_teamUserList=r.data.records||[]}))},submit:function(t){var e=this;this.$refs.uForm.validate(function(){var r=(0,i.default)(regeneratorRuntime.mark((function r(a){var i,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a){r.next=28;break}if(!((0,n.getTime)(e.form.startTime)>(0,n.getTime)(e.form.endTime))){r.next=4;break}return e.$refs.uToast.show({title:"结束时间不能小于开始时间！"}),r.abrupt("return");case 4:return 5==t?e.loadingSure=!0:e.loadingSave=!0,i=(0,o.default)({},e.form),s="",0==e.type&&(i.troExtId=e.id,s="troextmSubmit"),1==e.type&&(i.troTreeId=e.id,s="trotreemSubmit"),e.loading=!0,console.log(i,"params"),r.prev=11,r.next=14,e.$refs.chooseImage.getIds();case 14:return i.troPic=r.sent,r.next=17,e.$refs.chooseAudio.getIds();case 17:return i.troVoi=r.sent,r.next=20,e.$refs.chooseVideo.getIds();case 20:i.troVid=r.sent,r.next=27;break;case 23:return r.prev=23,r.t0=r["catch"](11),e.loading=!1,r.abrupt("return");case 27:m[s](i).then((function(){e.loading=!1,e.$refs.uToast.show({title:"维护成功！"}),setTimeout((function(){e.$goBack()}),500)})).catch((function(){e.loading=!1}));case 28:case"end":return r.stop()}}),r,null,[[11,23]])})));return function(t){return r.apply(this,arguments)}}())}}};e.default=c}}]);