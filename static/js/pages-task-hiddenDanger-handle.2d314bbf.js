(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-task-hiddenDanger-handle"],{"0095":function(e,t,a){var r=a("529c");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=a("4f06").default;i("58be491a",r,!0,{sourceMap:!1,shadowMode:!1})},"12af":function(e,t,a){var r=a("df4b");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=a("4f06").default;i("e22f6ecc",r,!0,{sourceMap:!1,shadowMode:!1})},"15cb":function(e,t,a){"use strict";var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("5530")),o=a("f4cb"),n=a("ecc0"),s=a("ec77"),l=(a("2e12"),r(a("9fec"))),d={components:{HandleForm:l.default},data:function(){return{type:"add",tag:0,teamId:"",loadingSure:!1,loadingSave:!1,id:"",form:{claUsers:"",claTime:"",claMonitorOpinions:""},rules:{claUsers:[{required:!0,message:"请选择处理人员"}],claTime:[{required:!0,message:"请选择处理时间"}]}}},onLoad:function(e){console.log(e,"options"),this.type=e.type||"add",this.id=e.id,this.tag=e.tag,this.teamId=e.teamId},onReady:function(){if("add"===this.type){this.form.claTime=(0,o.getNowTime)();var e=(0,n.getStore)("userInfo");this.form.troClaUsers=e.nick_name,this.form.claUsers=e.user_id}},methods:{submit:function(e){var t=this;5==e?this.loadingSure=!0:this.loadingSave=!0;var a=(0,i.default)((0,i.default)({},this.form),{},{id:this.id,state:e});console.log(a,"params"),(0,s.troextSubmit)(a).then((function(){t.loadingSure=!1,t.loadingSave=!1,t.$refs.uToast.show({title:"处理成功！"}),setTimeout((function(){t.$goBack()}),500)})).catch((function(){t.loadingSure=!1,t.loadingSave=!1}))}}};t.default=d},"529c":function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,".container[data-v-fa01bf12]{margin:0 %?16?%;background:#fff;-webkit-box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);-webkit-border-radius:%?24?%;border-radius:%?24?%;padding:%?15?% %?40?% %?15?% %?40?%;-webkit-box-sizing:border-box;box-sizing:border-box}.title[data-v-fa01bf12]{font-size:%?32?%;font-weight:700;margin-top:%?32?%}.btn[data-v-fa01bf12]{width:%?200?%;height:%?60?%!important;margin-top:%?24?%}.btn-plain[data-v-fa01bf12]{border-color:#05b2cc;color:#05b2cc}.custom-style[data-v-fa01bf12]{background-color:#05b2cc!important;color:#fff}",""]),e.exports=t},"544b":function(e,t,a){"use strict";a.r(t);var r=a("15cb"),i=a.n(r);for(var o in r)"default"!==o&&function(e){a.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},"71cb":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return r}));var r={customNavbar:a("384b").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("custom-navbar",{attrs:{title:"处理隐患",iconLeft:!0}}),a("v-uni-view",{staticClass:"container flex1"},[a("HandleForm",{ref:"HandleForm",attrs:{id:e.id,type:e.type,tag:e.tag,teamId:e.teamId}})],1)],1)},o=[]},"9fec":function(e,t,a){"use strict";a.r(t);var r=a("a9d4"),i=a("fd36");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("feb5");var n,s=a("f0c5"),l=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"e7777428",null,!1,r["a"],n);t["default"]=l.exports},a9d4:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return r}));var r={uForm:a("586b").default,uFormItem:a("e2f4").default,uInput:a("87aa").default,uButton:a("147a").default,uToast:a("4463").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("u-form",{ref:"uForm",attrs:{model:e.form}},[0==e.tag?[a("u-form-item",{attrs:{prop:"claUsers",label:"处理人员","label-width":"150"}},[a("efItem",{attrs:{data:e.dy_teamUserList,modelId:e.form.claUsers,multiple:!0,type:"add"===e.type||"edit"===e.type?"people":"label"},on:{"update:modelId":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"claUsers",t)},"update:model-id":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"claUsers",t)}},model:{value:e.form.troClaUsers,callback:function(t){e.$set(e.form,"troClaUsers",t)},expression:"form.troClaUsers"}})],1)]:e._e(),1==e.tag?[a("u-form-item",{attrs:{prop:"claUsers",label:"处理人员","label-width":"150"}},[a("efItem",{attrs:{data:e.dy_teamUserList,modelId:e.form.claUserIds,multiple:!0,type:"add"===e.type||"edit"===e.type?"people":"label"},on:{"update:modelId":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"claUserIds",t)},"update:model-id":function(t){arguments[0]=t=e.$handleEvent(t),e.$set(e.form,"claUserIds",t)}},model:{value:e.form.troClaUsers,callback:function(t){e.$set(e.form,"troClaUsers",t)},expression:"form.troClaUsers"}})],1)]:e._e(),a("u-form-item",{attrs:{label:"处理时间",prop:"claTime","label-width":"150"}},[a("efItem",{attrs:{endTime:e.$store.state.nowDate,type:"add"===e.type||"edit"===e.type?"time":"label"},model:{value:e.form.claTime,callback:function(t){e.$set(e.form,"claTime",t)},expression:"form.claTime"}})],1),a("v-uni-view",{staticClass:"title"},[e._v("处理前")]),a("u-form-item",{attrs:{label:"隐患处理前照片","label-position":"top"}},[a("chooseImage",{ref:"beforeImage",attrs:{images:e.form.claPicBefs,type:e.type,picType:"3"}})],1),a("u-form-item",{attrs:{label:"隐患处理前录音","label-position":"top"}},[a("chooseAudio",{ref:"beforeAudio",attrs:{audioList:e.form.claVoiBefs,type:e.type,picType:"3"}})],1),a("u-form-item",{attrs:{label:"隐患处理前视频","label-position":"top"}},[a("chooseVideo",{ref:"beforeVideo",attrs:{videoList:e.form.claVidBefs,type:e.type,picType:"3"}})],1),a("v-uni-view",{staticClass:"title"},[e._v("处理后")]),a("u-form-item",{attrs:{label:"隐患处理后照片","label-position":"top"}},[a("chooseImage",{ref:"afterImage",attrs:{images:e.form.claPics,type:e.type,picType:"3"}})],1),a("u-form-item",{attrs:{label:"隐患处理后录音","label-position":"top"}},[a("chooseAudio",{ref:"afterAudio",attrs:{audioList:e.form.claVois,type:e.type,picType:"3"}})],1),a("u-form-item",{attrs:{label:"隐患处理后视频","label-position":"top"}},[a("chooseVideo",{ref:"afterVideo",attrs:{videoList:e.form.claVids,type:e.type,picType:"3"}})],1),1==e.tag?[a("u-form-item",{attrs:{prop:"claWllen",label:"水平距离（m）","label-width":"240"}},[a("u-input",{attrs:{type:"number",disabled:"add"!==e.type&&"edit"!==e.type,"input-align":"right",placeholder:"add"===e.type||"edit"===e.type?"请输入":""},model:{value:e.form.claWllen,callback:function(t){e.$set(e.form,"claWllen",t)},expression:"form.claWllen"}})],1),a("u-form-item",{attrs:{prop:"claMwlen",label:"垂直距离（m）","label-width":"240"}},[a("u-input",{attrs:{type:"number",disabled:"add"!==e.type&&"edit"!==e.type,"input-align":"right",placeholder:"add"===e.type||"edit"===e.type?"请输入":""},model:{value:e.form.claMwlen,callback:function(t){e.$set(e.form,"claMwlen",t)},expression:"form.claMwlen"}})],1),a("u-form-item",{attrs:{label:"净空距离（m）","label-width":"240"}},[a("v-uni-view",{staticClass:"flex1 flex-end"},[e._v(e._s(e.claMelen))])],1)]:e._e(),a("u-form-item",{attrs:{prop:"claMonitorOpinions",label:"备注","label-width":"150","label-position":"top"}},[a("v-uni-view",{staticClass:"flex1"},["add"===e.type||"edit"===e.type?a("v-uni-view",[a("u-input",{attrs:{border:!0,placeholder:"请输入",type:"textarea"},model:{value:e.form.claMonitorOpinions,callback:function(t){e.$set(e.form,"claMonitorOpinions",t)},expression:"form.claMonitorOpinions"}})],1):e._e(),"details"===e.type?a("v-uni-view",{staticClass:"f-s-24"},[e._v(e._s(e.form.claMonitorOpinions))]):e._e()],1)],1)],2),"add"===e.type||"edit"===e.type?a("u-button",{directives:[{name:"permission",rawName:"v-permission",value:["user","teamLeader","zhuanze"],expression:"['user','teamLeader','zhuanze']"}],staticClass:"btn custom-style",attrs:{shape:"circle",loading:e.loadingSure,ripple:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit(5)}}},[e._v("确定")]):e._e(),"add"===e.type||"edit"===e.type?a("u-button",{directives:[{name:"permission",rawName:"v-permission",value:["user","teamLeader","zhuanze"],expression:"['user','teamLeader','zhuanze']"}],staticClass:"btn btn-plain",attrs:{shape:"circle",loading:e.loadingSave,ripple:!0,plain:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit(4)}}},[e._v("保存")]):e._e(),["5"].includes(e.status)?a("u-button",{directives:[{name:"permission",rawName:"v-permission",value:"teamLeader",expression:"'teamLeader'"}],staticClass:"btn custom-style",attrs:{shape:"circle",ripple:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toExamine("bzsh")}}},[e._v("审核")]):e._e(),["6"].includes(e.status)?a("u-button",{directives:[{name:"permission",rawName:"v-permission",value:"zhuanze",expression:"'zhuanze'"}],staticClass:"btn custom-style",attrs:{shape:"circle",ripple:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toExamine("zzsh")}}},[e._v("审核")]):e._e(),4==e.status&&"details"==e.type?a("u-button",{directives:[{name:"permission",rawName:"v-permission",value:["user","teamLeader","zhuanze"],expression:"['user','teamLeader','zhuanze']"}],staticClass:"btn custom-style",attrs:{type:"primary",shape:"circle",ripple:!0},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toHandle.apply(void 0,arguments)}}},[e._v("编辑")]):e._e(),a("u-toast",{ref:"uToast"})],1)},o=[]},cccc:function(e,t,a){"use strict";a.r(t);var r=a("71cb"),i=a("544b");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("ec78");var n,s=a("f0c5"),l=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"fa01bf12",null,!1,r["a"],n);t["default"]=l.exports},df4b:function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,".container[data-v-e7777428]{margin:0 %?16?%;background:#fff;-webkit-box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);box-shadow:0 %?4?% %?16?% 0 rgba(14,23,37,.08);-webkit-border-radius:%?24?%;border-radius:%?24?%;padding:%?15?% %?40?% %?15?% %?40?%;-webkit-box-sizing:border-box;box-sizing:border-box}.title[data-v-e7777428]{font-size:%?32?%;font-weight:700;margin-top:%?32?%}.btn[data-v-e7777428]{width:%?200?%;height:%?60?%!important;margin-top:%?24?%}.btn-plain[data-v-e7777428]{border-color:#05b2cc;color:#05b2cc}.custom-style[data-v-e7777428]{background-color:#05b2cc!important;color:#fff}",""]),e.exports=t},ec77:function(e,t,a){"use strict";var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.getTroTypeLevel=t.trotreeSubmit=t.depleaderListman=t.trotreemSubmit=t.troclaGetBasis=t.troclaGetType=t.trotreehSave=t.trotreeDetail=t.trotreeList=t.troexthSave=t.troextDetail=t.troextmSubmit=t.troextSubmit=t.troextList=void 0;var i=r(a("5f30")),o=function(e){return(0,i.default)({url:"/blade-sd/troext/list",method:"get",data:e})};t.troextList=o;var n=function(e){return(0,i.default)({url:"/blade-sd/troext/submit",method:"post",data:e})};t.troextSubmit=n;var s=function(e){return(0,i.default)({url:"/blade-sd/troextm/submit",method:"post",data:e})};t.troextmSubmit=s;var l=function(e){return(0,i.default)({url:"/blade-sd/troext/detail",method:"get",data:e})};t.troextDetail=l;var d=function(e){return(0,i.default)({url:"/blade-sd/troexth/save",method:"post",data:e})};t.troexthSave=d;var u=function(e){return(0,i.default)({url:"/blade-sd/trotree/list",method:"get",data:e})};t.trotreeList=u;var c=function(e){return(0,i.default)({url:"/blade-sd/trotree/detail",method:"get",data:e})};t.trotreeDetail=c;var f=function(e){return(0,i.default)({url:"/blade-sd/trotreeh/save",method:"post",data:e})};t.trotreehSave=f;var m=function(e){return(0,i.default)({url:"/blade-sd/trocla/getType",method:"get",data:e})};t.troclaGetType=m;var p=function(e){return(0,i.default)({url:"/blade-sd/trocla/getBasis",method:"get",data:e})};t.troclaGetBasis=p;var b=function(e){return(0,i.default)({url:"/blade-sd/trotreem/submit",method:"post",data:e})};t.trotreemSubmit=b;var v=function(e){return(0,i.default)({url:"/blade-sd/depleader/listman",method:"get",data:e})};t.depleaderListman=v;var h=function(e){return(0,i.default)({url:"/blade-sd/trotree/submit",method:"post",data:e})};t.trotreeSubmit=h;var g=function(e){return(0,i.default)({url:"/trocla/getTroTypeLevel",method:"get",data:e})};t.getTroTypeLevel=g},ec78:function(e,t,a){"use strict";var r=a("0095"),i=a.n(r);i.a},fd36:function(e,t,a){"use strict";a.r(t);var r=a("ffa5"),i=a.n(r);for(var o in r)"default"!==o&&function(e){a.d(t,e,(function(){return r[e]}))}(o);t["default"]=i.a},feb5:function(e,t,a){"use strict";var r=a("12af"),i=a.n(r);i.a},ffa5:function(e,t,a){"use strict";var r=a("4ea4");a("b680"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("5530"));a("96cf");var o=r(a("1da1")),n=r(a("b35f")),s=a("f4cb"),l=a("ecc0"),d=a("ec77"),u=a("2e12"),c={troextDetail:function(e){return(0,d.troextDetail)(e)},trotreeDetail:function(e){return(0,d.trotreeDetail)(e)}},f={troextSubmit:function(e){return(0,d.troextSubmit)(e)},trotreeSubmit:function(e){return(0,d.trotreeSubmit)(e)}},m={props:{id:{type:String,default:""},type:{type:String,default:"add"},tag:{default:0},teamId:{type:String,default:""},details:{type:Object,default:function(){}}},components:{efItem:n.default},data:function(){return{loadingSure:!1,loadingSave:!1,form:{claUsers:"",claUserIds:"",claTime:"",claMonitorOpinions:""},rules:{claUsers:[{required:0==this.tag,message:"请选择处理人员"}],claUserIds:[{required:1==this.tag,message:"请选择处理人员"}],claTime:[{required:!0,message:"请选择处理时间"}]},dy_teamUserList:[]}},created:function(){console.log(this.type,"type"),"edit"==this.type&&this._troextDetail(),this._selectTeamUserList()},mounted:function(){if(this.$refs.uForm.setRules(this.rules),"add"===this.type){this.form.claTime=(0,s.getNowTime)();var e=(0,l.getStore)("userInfo");this.form.troClaUsers=e.nick_name,this.form.claUsers=e.user_id}},watch:{details:{handler:function(e){console.log(e,"nval,data66"),this.form=e,this.$emit("over")},deep:!0}},computed:{status:function(){return this.form.state||""},claMelen:function(){var e=this.form,t=e.claWllen,a=e.claMwlen,r="";return t&&a&&(r=Math.sqrt(t*t+a*a),String(r).length>5&&(r=r.toFixed(2)),this.$set(this.form,"claMelen",r)),r}},methods:{_selectTeamUserList:function(){var e=this;(0,u.selectTeamUserList)({deptId:this.teamId}).then((function(t){var a=t.data;e.dy_teamUserList=a.data.records||[]}))},submit:function(e){var t=this;this.$refs.uForm.validate(function(){var a=(0,o.default)(regeneratorRuntime.mark((function a(r){var o,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!r){a.next=32;break}return 5==e?t.loadingSure=!0:t.loadingSave=!0,o=(0,i.default)((0,i.default)({},t.form),{},{id:t.id,state:e}),delete o.troClaUsers,n=0==t.tag?"troextSubmit":"trotreeSubmit",a.prev=5,a.next=8,t.$refs.beforeImage.getIds();case 8:return o.claPicBef=a.sent,a.next=11,t.$refs.beforeAudio.getIds();case 11:return o.claVoiBef=a.sent,a.next=14,t.$refs.beforeVideo.getIds();case 14:return o.claVidBef=a.sent,a.next=17,t.$refs.afterImage.getIds();case 17:return o.claPic=a.sent,a.next=20,t.$refs.afterAudio.getIds();case 20:return o.claVoi=a.sent,a.next=23,t.$refs.afterVideo.getIds();case 23:o.claVid=a.sent,a.next=31;break;case 26:return a.prev=26,a.t0=a["catch"](5),t.loadingSure=!1,t.loadingSave=!1,a.abrupt("return");case 31:f[n](o).then((function(){t.loadingSure=!1,t.loadingSave=!1,t.$refs.uToast.show({title:"处理成功！"}),setTimeout((function(){t.$goBack()}),500)})).catch((function(){t.loadingSure=!1,t.loadingSave=!1}));case 32:case"end":return a.stop()}}),a,null,[[5,26]])})));return function(e){return a.apply(this,arguments)}}())},toExamine:function(e){uni.navigateTo({url:"pages/task/hiddenDanger/examine?id="+this.id+"&stateObj="+e+"&type="+this.tag})},toHandle:function(){uni.navigateTo({url:"pages/task/hiddenDanger/handle?id="+this.id+"&type=edit&tag="+this.tag})},_troextDetail:function(){var e=this;if(this.id){var t={id:this.id},a=0==this.tag?"troextDetail":"trotreeDetail";c[a](t).then((function(t){console.log(t,"隐患详情==="),e.form=t.data.data}))}}}};t.default=m}}]);